<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="../../../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>MPLAB® Harmony 3 Graphics Application Examples for SAM 9x60 Family | Harmony 3 Graphics Application Examples for SAM 9x60 Family Package</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="MPLAB® Harmony 3 Graphics Application Examples for SAM 9x60 Family" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 Graphics Application Examples for SAM 9x60 Family Package" /> <meta property="og:description" content="Harmony 3 Graphics Application Examples for SAM 9x60 Family Package" /> <link rel="canonical" href="../../../../apps/isi_camera/firmware/isi_cam_sam9x60_ek.X/" /> <meta property="og:url" content="../../../../apps/isi_camera/firmware/isi_cam_sam9x60_ek.X/" /> <meta property="og:site_name" content="MPLAB® Harmony 3 Graphics Application Examples for SAM 9x60 Family" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="MPLAB® Harmony 3 Graphics Application Examples for SAM 9x60 Family" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Harmony 3 Graphics Application Examples for SAM 9x60 Family Package","headline":"MPLAB® Harmony 3 Graphics Application Examples for SAM 9x60 Family","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../../../assets/images/vendor/mhgs_logo_transparent.png"}},"url":"../../../../apps/isi_camera/firmware/isi_cam_sam9x60_ek.X/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="../../../../" class="nav-list-link">Harmony 3 Graphics SAM 9x60 Applications Package</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../../apps/readme.html" class="nav-list-link">Example Applications</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../../apps/isi_camera/" class="nav-list-link">ISI Camera</a></li><li class="nav-list-item "><a href="../../../../apps/lvgl_showcase/" class="nav-list-link">LVGL Showcase</a></li><li class="nav-list-item "><a href="../../../../apps/legato_quickstart/" class="nav-list-link">Legato Quickstart</a></li><li class="nav-list-item "><a href="../../../../apps/blank_canvas_quickstart/" class="nav-list-link">Blank Canvas Quickstart</a></li><li class="nav-list-item "><a href="../../../../apps/blank_quickstart/" class="nav-list-link">Blank Quickstart</a></li><li class="nav-list-item "><a href="../../../../apps/blank_quickstart_db/" class="nav-list-link">Blank Quickstart with Double Buffering</a></li><li class="nav-list-item "><a href="../../../../apps/legato_canvas_quickstart/" class="nav-list-link">Legato Canvas Quickstart</a></li><li class="nav-list-item "><a href="../../../../apps/legato_dashboard/" class="nav-list-link">Legato Dashboard</a></li></ul></li><li class="nav-list-item"><a href="../../../../release_notes.html" class="nav-list-link">Release notes</a></li><li class="nav-list-item"><a href="../../../../mplab_harmony_license.html" class="nav-list-link">License</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search MPLAB® Harmony 3 Graphics Application Examples for SAM 9x60 Family" aria-label="Search MPLAB® Harmony 3 Graphics Application Examples for SAM 9x60 Family" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <p><img src="/gfx_apps_sam_9x60/images/mhgs.png" alt="" /> isi_cam_sam9x60_ek.X</p> <h2 id="defining-the-architecture"> <a href="#defining-the-architecture" aria-labelledby="defining-the-architecture" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Defining the Architecture </h2> <p><img src="/gfx_apps_sam_9x60/images/isi_block_diagram.png" alt="" /></p> <p>This application demonstrates how to use the Image Sensor Interface peripheral with an off-the-shelf image sensor. For this example, an arducam OV5640 Camera Module is used. The application will store the captured images to a USB storage device in TGA format. When user pushes SW1 button, a full-size ISI codec capture is initiated and the image is stored in the USB storage device.</p> <h3 id="demonstration-features"> <a href="#demonstration-features" aria-labelledby="demonstration-features" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Demonstration Features </h3> <ul> <li>Image Sensor Interface</li> <li>USB MSD Write</li> <li>Analog Button</li> </ul> <h2 id="creating-the-project-graph"> <a href="#creating-the-project-graph" aria-labelledby="creating-the-project-graph" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating the Project Graph </h2> <p><img src="/gfx_apps_sam_9x60/images/isi_cam_graph.png" alt="" /></p> <p>The Project Graph diagram shows the Harmony components that are included in this application. Lines between components are drawn to satisfy components that depend on a capability that another component provides.</p> <p>The I2C driver in this project is used for communication with the OV5640 image sensor.</p> <p>The pins are configured as follows:</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Pin Number</th> <th style="text-align: left">Pin ID</th> <th style="text-align: left">Custom Name</th> <th style="text-align: left">Function</th> <th style="text-align: left">Direction</th> <th style="text-align: left">Latch</th> <th style="text-align: left">PIO Interrupt</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">P2</td> <td style="text-align: left">PA0</td> <td style="text-align: left"> </td> <td style="text-align: left">FLEXCOM0_IO0</td> <td style="text-align: left">n/a</td> <td style="text-align: left">n/a</td> <td style="text-align: left">Disabled</td> </tr> <tr> <td style="text-align: left">M3</td> <td style="text-align: left">PA1</td> <td style="text-align: left"> </td> <td style="text-align: left">FLEXCOM0_IO1</td> <td style="text-align: left">n/a</td> <td style="text-align: left">n/a</td> <td style="text-align: left">Disabled</td> </tr> <tr> <td style="text-align: left">D6</td> <td style="text-align: left">PB13</td> <td style="text-align: left">LED_RED</td> <td style="text-align: left">LED_AH</td> <td style="text-align: left">Out</td> <td style="text-align: left">Low</td> <td style="text-align: left">Disabled</td> </tr> <tr> <td style="text-align: left">C2</td> <td style="text-align: left">PB12</td> <td style="text-align: left">LED_GREEN</td> <td style="text-align: left">LED_AH</td> <td style="text-align: left">Out</td> <td style="text-align: left">Low</td> <td style="text-align: left">Disabled</td> </tr> <tr> <td style="text-align: left">A4</td> <td style="text-align: left">PB13</td> <td style="text-align: left">LED_BLUE</td> <td style="text-align: left">LED_AH</td> <td style="text-align: left">Out</td> <td style="text-align: left">Low</td> <td style="text-align: left">Disabled</td> </tr> <tr> <td style="text-align: left">R6</td> <td style="text-align: left">PC16</td> <td style="text-align: left">BSP_OV5640_RESET</td> <td style="text-align: left">GPIO</td> <td style="text-align: left">Out</td> <td style="text-align: left">High</td> <td style="text-align: left">Disabled</td> </tr> <tr> <td style="text-align: left">R8</td> <td style="text-align: left">PC24</td> <td style="text-align: left">BSP_OV5640_PDNW</td> <td style="text-align: left">GPIO</td> <td style="text-align: left">Out</td> <td style="text-align: left">High</td> <td style="text-align: left">Disabled</td> </tr> <tr> <td style="text-align: left">L13</td> <td style="text-align: left">PD18</td> <td style="text-align: left">SWITCH_AL_PD18</td> <td style="text-align: left">SWITCH_AL</td> <td style="text-align: left">In</td> <td style="text-align: left">Low</td> <td style="text-align: left">Both Edge</td> </tr> </tbody> </table></div> <p>The interrupt for PIOD_IRQn (the interrupt for SW1) needs to be set to a higher priority than the default. For the purposes of this demo it is set to “Very High Priority”.</p> <p>The peripheral clocks need to be turned on for “ISI”, “PIOD”, and “UHPHS_EHCI”.</p> <p>Programmable Clock Controler 0 (PCLK0) needs to be enabled and needs to be configured to use the MAINCK as its source. This provides a 12 MHz clock pulse to the OV5640 module.</p> <p><b>Note: The OV5640 image sensor is an off-the-shelf module and is not officially supported by MPLAB Harmony 3. While a driver for this module is included as part of this demo, it is not guaranteed to be complete. Nor are the OV5640 configuration values guaranteed to be optimal. Consequently, the images produced by this demo may be of lower quality. The primary purpose of this application is to demonstrate the functionality of the Image Sensor Interface module. Additional user effort may be required to determine the most optimal camera module settings.</b></p> <h2 id="building-the-application"> <a href="#building-the-application" aria-labelledby="building-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Building the Application </h2> <p>The parent directory for this application is gfx/apps/isi_camera. To build this application, use MPLAB X IDE to open the gfx/apps/isi_camera/start/firmware/isi_cam_sam9x60_ek.X project folder and press F11. A successful build will generate a harmony.bin file in dist\9x60\production in the project folder.</p> <p>The following table lists configuration properties:</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Project Name</th> <th style="text-align: left">BSP Used</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">isi_cam_sam9x60_ek.X</td> <td style="text-align: left"><a href="https://www.microchip.com/developmenttools/ProductDetails/DT100126">SAM 9x60 Evaluation Kit</a></td> <td style="text-align: left">9x60 Evaluation Kit Image Sensor Interface and OV5640 image sensor.</td> </tr> </tbody> </table></div> <p><b>Note: This application may contain custom code that is marked by the comments // START OF CUSTOM CODE … and // END OF CUSTOM CODE. When using the MPLAB Harmony Configurator to regenerate the application code, use the “ALL” merging strategy and do not remove or replace the custom code.</b></p> <h2 id="configuring-the-hardware"> <a href="#configuring-the-hardware" aria-labelledby="configuring-the-hardware" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuring the Hardware </h2> <p>Configure the hardware as follows:</p> <ul> <li>The OV5640 CMOS camera module is wired to the 12-bit ISI conector (J17) on the SAM9X60-EK using the following wiring diagram:</li> </ul> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: center">Module Function</th> <th style="text-align: center">OV5640 Module Pin</th> <th style="text-align: center">ISI Pin</th> <th style="text-align: center">ISI Function</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">VCC</td> <td style="text-align: center">1</td> <td style="text-align: center">1</td> <td style="text-align: center">3.3 VCC</td> </tr> <tr> <td style="text-align: center">GND</td> <td style="text-align: center">2</td> <td style="text-align: center">9</td> <td style="text-align: center">GND</td> </tr> <tr> <td style="text-align: center">SCL</td> <td style="text-align: center">3</td> <td style="text-align: center">7 (PA00)</td> <td style="text-align: center">TWI Clock</td> </tr> <tr> <td style="text-align: center">SDA</td> <td style="text-align: center">4</td> <td style="text-align: center">8 (PA01)</td> <td style="text-align: center">TWI Data</td> </tr> <tr> <td style="text-align: center">VSYNC</td> <td style="text-align: center">5</td> <td style="text-align: center">12 (PC13)</td> <td style="text-align: center">VSYNC</td> </tr> <tr> <td style="text-align: center">HREF</td> <td style="text-align: center">6</td> <td style="text-align: center">14 (PC14)</td> <td style="text-align: center">HSYNC</td> </tr> <tr> <td style="text-align: center">PCLK</td> <td style="text-align: center">7</td> <td style="text-align: center">16 (PC12)</td> <td style="text-align: center">PCLK</td> </tr> <tr> <td style="text-align: center">XCLK</td> <td style="text-align: center">8</td> <td style="text-align: center">10 (PC15)</td> <td style="text-align: center">MCLK</td> </tr> <tr> <td style="text-align: center">DOUT9</td> <td style="text-align: center">9</td> <td style="text-align: center">25 (PC07)</td> <td style="text-align: center">D7</td> </tr> <tr> <td style="text-align: center">DOUT8</td> <td style="text-align: center">10</td> <td style="text-align: center">24 (PC06)</td> <td style="text-align: center">D6</td> </tr> <tr> <td style="text-align: center">DOUT7</td> <td style="text-align: center">11</td> <td style="text-align: center">23 (PC05)</td> <td style="text-align: center">D5</td> </tr> <tr> <td style="text-align: center">DOUT6</td> <td style="text-align: center">12</td> <td style="text-align: center">22 (PC04)</td> <td style="text-align: center">D4</td> </tr> <tr> <td style="text-align: center">DOUT5</td> <td style="text-align: center">13</td> <td style="text-align: center">21 (PC03)</td> <td style="text-align: center">D3</td> </tr> <tr> <td style="text-align: center">DOUT4</td> <td style="text-align: center">14</td> <td style="text-align: center">20 (PC02)</td> <td style="text-align: center">D2</td> </tr> <tr> <td style="text-align: center">DOUT3</td> <td style="text-align: center">15</td> <td style="text-align: center">19 (PC01)</td> <td style="text-align: center">D1</td> </tr> <tr> <td style="text-align: center">DOUT2</td> <td style="text-align: center">16</td> <td style="text-align: center">18 (PC00)</td> <td style="text-align: center">D0</td> </tr> <tr> <td style="text-align: center">DOUT1</td> <td style="text-align: center">17</td> <td style="text-align: center">~</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">DOUT0</td> <td style="text-align: center">18</td> <td style="text-align: center">~</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">RESET</td> <td style="text-align: center">19</td> <td style="text-align: center">5 (PC16)</td> <td style="text-align: center">RESET</td> </tr> <tr> <td style="text-align: center">PWDN</td> <td style="text-align: center">20</td> <td style="text-align: center">~</td> <td style="text-align: center"> </td> </tr> <tr> <td style="text-align: center">AFVDD</td> <td style="text-align: center">21</td> <td style="text-align: center">3</td> <td style="text-align: center">VCC</td> </tr> <tr> <td style="text-align: center">STB</td> <td style="text-align: center">22</td> <td style="text-align: center">~</td> <td style="text-align: center"> </td> </tr> </tbody> </table></div> <p>Note: For 8-bit YCbCr or RGB raw/565 output use D[9:2] of the sensor.</p> <p><img src="/gfx_apps_sam_9x60/images/isi_9x60_setup.png" alt="" /></p> <ul> <li> <p>Take an SD Card formatted with FAT32 file system, and copy the boot.bin binary file from this <a href="../../../boot_image/boot.bin">location</a>. Also copy the harmony.bin file you generated from the “Building the Application” section.</p> </li> <li> <p>Insert the SD card to J4 of the SAM 9X60 Evaluation kit and power up the board by connecting the power adapter to power connector J1 or a powered USB cable to the USB port J7 on the SAM 9x60 Evaluation Kit board.</p> </li> </ul> <h2 id="running-the-demonstration"> <a href="#running-the-demonstration" aria-labelledby="running-the-demonstration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Running the Demonstration </h2> <p>When power-on is successful, the multi-colored LED will turn red. This means the application is waiting for the user to insert a FAT32-formated USB storage device into the 9x60 USB port.</p> <p><b>When a properly formatted USB storage device is connected to J8 of the SAM 9X60 Evaluation kit and mounted, the LED will turn green.</b> The application will then begin incrementally writing captured preview images from the ISI’s preview pipeline to the USB storage device, in the TGA format.</p> <p><b>To initiate a full-size ISI codec capture, press the user switch SW1.</b> The LED will turn blue to while the user pushes SW1. The application will write a full size image to the USB storage device, in a raw YCbCr 422 format.</p> <p><b>To properly unmount the USB storage device, press SW1 for 4-5 seconds.</b> The LED will turn red when the unmount operation is complete. The USB storage device can then be removed.</p> <p>A python script has been included with this application (ycbcr2rga.py) that can convert the codec captures (files with *.yuv extension) into PNG type images. This python script requres the pypng file to be installed. Instructions for this can be found on the web.</p> <p>ycbcr2rga usage: python ycbcr2rga {filename}.yuv {image width} {image height}</p> <hr /> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2023 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='../../../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2024 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
